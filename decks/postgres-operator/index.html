<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Crunchy Data PostgreSQL Operator</title>

    <meta name="description" content="Crunchy Data PostgreSQL Operator">
    <meta name="author" content="Sarah Conway">

		<link rel="stylesheet" href="css/reveal.css">
	  <link rel="stylesheet" href="css/theme/crunchy.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

        <style>
            .reveal {
              font-size: 30px;
             }

            #li30 li { line-height:30px }
        </style>

	</head>
	<body>

		<div class="reveal">
			<div class="slides">

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>DON'T PANIC: <br>USE THE POSTGRESQL OPERATOR FOR KUBERNETES AND OPENSHIFT</h2>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
	        <h2>Crunchy Data Solutions, Inc</h2>
					<ul>
						<li>Industry leader in providing enterprise PostgreSQL support and open source solutions</li>
						<li>Crunchy Certified PostgreSQL
							<ul>
								<li>100% Open Source PostgreSQL</li>
								<li>Emphasis in Data Security and Compliance</li>
	              <li>Common Criteria EAL 2+ Certified</li>
								<li>World class PostgreSQL expertise - includes Core Developers, Committers and Major Contributors.</li>
								<li>Responsible for a number of PostgreSQL enhancements including pgJDBC, pgBackRest, pgAudit, pgPartman, and others</li>
							</ul>
						</li>
						<li>We're hiring!
							<ul>
								<li><a href="https://www.crunchydata.com/" target="_blank">https://www.crunchydata.com/</a></li>
	              <li>DBAs, Systems Engineers, Container Experts</li>
							</ul>
						</li>
					</ul>
        </section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Outline</h2>
					<ul>
						<li>Introduction</li>
						<li>Operator Basics</li>
						<li>Deployment</li>
						<li>Why the Operator?</li>
						<li>PostgreSQL Container Design Features</li>
						<li>Building Blocks</li>
						<li>Operator Usage</li>
						<li>Roadmap</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Operator Basics</h2>
					<ul>
						<li><b>Open Source</b> - <a href="https://github.com/crunchydata/postgres-operator">https://github.com/crunchydata/postgres-operator</a></li>
						<li><b>Controller</b> - component run per-namespace on Kubernetes or OpenShift</li>
						<li><b>REST API</b> - Provides a REST API and a REST client</li>
						<li><b>Command Line Interface</b> - to control the Operator and define metadata</li>
						<li><b>Deployment</b> - runs as standard Deployment, watches for changes to CRDs</li>
						<li><b>Custom Resource Definitions</b> - stores deployment metadata</li>
						<li><b>Security</b> - Provides RBAC authorization and TLS/Basic Auth security</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Operator Architecture</h2>
					<img src="images/architecture.jpg" width="700">
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>PostgreSQL Deployment</h2>
					<img src="images/postgres-operator.png" width="700">
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Why the Operator?</h2>
					<ul>
						<li>Automation</li>
						<li>Standardization</li>
						<li>Ease of Use</li>
						<li>Large Scale Deployments</li>
						<li>Complex Orchestrations</li>
						<li>Separation of Tasks</li>
						<li>Lightweight</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>PostgreSQL Container Design Features</h2>
					<ul>
						<li><b>Clustering</b> - runs as a primary or replica</li>
						<li><b>Replication</b> - allows for synchronous or asynchronous replication</li>
						<li><b>Predefined objects</b> - initializes example database objects in setup.sql</li>
						<li><b>Locale support</b> - specify any locale for use</li>
						<li><b>Secrets support</b> - store database credentials with Kubernetes secrets</li>
						<li><b>Config override</b> - override pg_hba.conf, postgresql.conf, setup.sql</li>
						<li><b>Openshift Random UID support</b> - use random UID for <b>postgres</b> user</li>
						<li><b>Backup/Restore</b> - allows restore using a predefined backup archive</li>
						<li><b>Up-to-Date PostgreSQL Images</b> -
							<ul>
								<li>PostgreSQL Version 9.5.14</li>
								<li>PostgreSQL Version 9.6.10</li>
								<li>PostgreSQL Version 10.5</li>
							</ul>
						</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Building Blocks</h2>
					<ul>
						<li><b>crunchy-postgres</b> - runs PostgreSQL</li>
						<li><b>crunchy-backup</b> - performs pg_basebackup on a database container</li>
						<li><b>crunchy-backrest</b> - deploys pgBackRest alongside the database</li>
						<li><b>crunchy-upgrade</b> - runs pg_upgrade to perform a major upgrade</li>
						<li><b>crunchy-pgpool</b> - open source load-balancing with pgPool II</li>
						<li><b>crunchy-pgbadger</b> - deploys pgBadger</li>
						<li><b>crunchy-collect</b> - monitors with postgres_exporter & node_exporter</li>
						<li><b>crunchy-grafana</b> - deploys Grafana</li>
						<li><b>crunchy-prometheus</b> - deploys Prometheus</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Resources</h2>
					<ul>
						<li><b>Project</b> - <a href="https://github.com/CrunchyData/postgres-operator">https://github.com/CrunchyData/postgres-operator</a></li>
						<li><b>Documentation</b> - <a href="https://crunchydata.github.io/postgres-operator/">https://crunchydata.github.io/postgres-operator</a></li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Minimum Requirements</h2>
					<ul>
						<li>Docker 1.12+</li>
						<li>Kubernetes 1.7.0+</li>
						<li>OpenShift Origin 1.7.0+</li>
						<li>Golang 1.8+</li>
						<li>CentOS 7 or RHEL 7</li>
					</ul>

				</section>

				<section>
						<h2>create cluster</h2>
						<pre><code data-trim>
							pgo create cluster NAME [flags]
							[-e, --series]
							[-l, --labels]
							[-z, --policies]
							[-w, --password]
							[-m, --metrics]
							[-g, --custom-config]
							[-s, --secret-from]
							[-c, --ccp-image-tag]
							[-x, --backup-path]
							[-p, --backup-pvc]
							[--service-type]
							[--pgpool]
							[--pgpool-secret]
							[--pgbadger]
							[--pgbackrest]
							[--autofail]
							[--archive]
							[--storage-config]
							[--replica-storage-config]
							[--resources-config]
							[--node-label]
						</code></pre>
				</section>

				<section>
						<h2>show cluster</h2>
						<pre><code data-trim>
							pgo show (cluster | upgrade | config | backup | pvc | policy | user) (NAME | all) [flags]
							[-o, --output]
							[-s, --selector]
							[-v, --version]
						</code></pre>
				</section>

				<section>
						<h2>delete cluster</h2>
						<pre><code data-trim>
							pgo delete (cluster | policy | upgrade | user | backup) NAME [flags]
							[-b, --delete-backups]
							[-d, --delete-data]
							[-n, --no-prompt]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>test cluster</h2>
						<pre><code data-trim>
							pgo test NAME [flags]
							[-o, --output]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>create policy</h2>
						<pre><code data-trim>
							pgo create policy NAME [flags]
							[-i, --in-file]
							[-u, --url]
						</code></pre>
				</section>

				<section>
						<h2>apply policy</h2>
						<pre><code data-trim>
							pgo apply NAME [flags]
							[-d, --dry-run]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>user management</h2>
						<pre><code data-trim>
							pgo user [flags]
							[-c, --change-password]
							[-b, --db]
							[-e, --expired]
							[-m, --managed]
							[-s, --selector]
							[-u, --update-passwords]
							[-v, --valid-days]
						</code></pre>
				</section>

				<section>
						<h2>show user</h2>
						<pre><code data-trim>
							pgo show user NAME [flags]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>label Clusters</h2>
						<pre><code data-trim>
							pgo label [flags]
							[-x, --delete-label]
							[-d, --dry-run]
							[-l, --label]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>data loading</h2>
						<pre><code data-trim>
							pgo load [flags]
							[-l, --load-config]
							[-z, --policies]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>pgo reload</h2>
						<pre><code data-trim>
							pgo reload NAME [flags]
							[-n, --no-prompt]
							[--selector]
						</code></pre>
				</section>

				<section>
						<h2>manual failover</h2>
						<pre><code data-trim>
							pgo failover [flags]
							[-n, --no-prompt]
							[--query]
							[--target]
						</code></pre>
				</section>

				<section>
						<h2>scale cluster</h2>
						<pre><code data-trim>
							pgo scale NAME [flags]
							[-c, --ccp-image-tag]
							[-r, --replica-count]
							[-n, --no-prompt]
							[--target]
							[--scale-down-target]
							[--service-type]
							[--query]
							[--delete-data]
							[--node-label]
							[--storage-config]
							[--resources-config]
						</code></pre>
				</section>

				<section>
						<h2>upgrade cluster</h2>
						<pre><code data-trim>
							pgo upgrade NAME [flags]
							[-c, --ccp-image-tag]
							[-t, --upgrade-type]
						</code></pre>
				</section>

				<section>
						<h2>disk capacity</h2>
						<pre><code data-trim>
							pgo df [flags]
							[-s, --selector]
						</code></pre>
				</section>

				<section>
						<h2>operator status</h2>
						<pre><code data-trim>
							pgo status [flags]
							[-o, --output]
						</code></pre>
				</section>

				<section>
						<h2>general</h2>
						<pre><code data-trim>
							pgo version

							pgo [command] --help
						</code></pre>
				</section>

				<section>
						<h2>pgo.yaml</h2>
						<pre><code data-trim>
							Cluster:
							  CCPImagePrefix:  crunchydata
							  Metrics:  false
							  Badger:  false
							  CCPImageTag:  centos7-10.5-2.1.0
							  Port:  5432
							  User:  testuser
							  Database:  userdb
							  PasswordAgeDays:  60
							  PasswordLength:  8
							  Strategy:  1
							  Replicas:  0
							  ArchiveMode:  false
							  ArchiveTimeout:  60
							  ServiceType:  ClusterIP
							  Backrest:  false
							  Autofail:  false
							PrimaryStorage: storage1
							BackupStorage: storage1
							ReplicaStorage: storage1
							Storage:
							  storage1:
							    AccessMode:  ReadWriteMany
							    Size:  200M
							    StorageType:  create
							    SupplementalGroups:  65534
							  storage2:
							    AccessMode:  ReadWriteOnce
							    Size:  333M
							    StorageType:  dynamic
							    StorageClass:  gluster-heketi
							    Fsgroup:  26
							  storage3:
							    AccessMode:  ReadWriteOnce
							    Size:  440M
							    StorageType:  dynamic
							    StorageClass:  fast
							    Fsgroup:  26
							DefaultContainerResource:
							ContainerResources:
							  small:
							    RequestsMemory:  512Mi
							    RequestsCPU:  0.1
							    LimitsMemory:  512Mi
							    LimitsCPU:  0.1
							  large:
							    RequestsMemory:  2Gi
							    RequestsCPU:  2.0
							    LimitsMemory:  2Gi
							    LimitsCPU:  4.0
							Pgo:
							  AutofailSleepSeconds:  9
							  Audit:  false
							  LSPVCTemplate:  /config/pgo.lspvc-template.json
							  LoadTemplate:  /config/pgo.load-template.json
							  COImagePrefix:  crunchydata
							  COImageTag:  centos7-3.2.0
						</code></pre>
				</section>

				<section>
						<h2>show configuration</h2>
						<pre><code data-trim>
							pgo show config
						</code></pre>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Roadmap</h2>
					<ul>
						<li><a href="https://github.com/CrunchyData/postgres-operator/releases">https://github.com/CrunchyData/postgres-operator/releases</a></li>
						<li>Where we've been
							<ul>
								<li>pgBackRest</li>
								<li>pgBadger</li>
								<li>Reload</li>
								<li>Service Type</li>
							</ul>
						</li>
						<li>Where we're going
							<ul>
								<li>pgo-osb</li>
								<li>pgo-ui</li>
								<li>Kubernetes Ingress Integration</li>
								<li>Disk-level Cloning</li>
								<li>PostgreSQL-level Cloning</li>
							</ul>
						</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Operator GUI</h2>
					<img src="images/pgoui.jpg" width="700">
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Summary</h2>
					<ul>
						<li>Securely provision thousands of databases in a reliable, auditable environment</li>
						<li>Allow for deployment to any cloud platform, public or private, from a single interface</li>
						<li>Create highly-available PostgreSQL clusters with full DR capabilities for databases of terabyte scale</li>
						<li>Instantly provision databases that meet complex compliance requirements</li>
					</ul>
				</section>

				<section data-background="css/theme/crunchy_white_bg.png">
					<h2>Thank You!</h2>
					<ul>
						<li>Sarah Conway - sarah.conway@crunchydata.com</li>
						<li>Jeff McCormick - jeff.mccormick@crunchydata.com</li>
						<li>Robert Bates, robert.bates@crunchydata.com, 770-330-5838</li>
						<li>Paul Laurence, paul@crunchydata.com, 843-737-6045</li>
						<li>Slides - <a href="https://goo.gl/UCptQp" target="_blank">https://goo.gl/UCptQp</a></li>
						<li>Project - <a href="https://github.com/CrunchyData/postgres-operator" target="_blank">https://github.com/CrunchyData/postgres-operator</a></li>
						<li>Documentation - <a href="https://crunchydata.github.io/postgres-operator" target="_blank">https://crunchydata.github.io/postgres-operator</a></li>
						<li>Crunchy Data Solutions, Inc - <a href="http://www.crunchydata.com" target="_blank">crunchydata.com</a></li>
						<li>Make cool presentations like this - <a href="https://github.com/hakimel/reveal.js/" target="_blank">reveal.js</a></li>
					</ul>
         </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				],
                slideNumber: true,
                history: true,
                controlsLayout: "edges"
			});
		</script>
	</body>
</html>
